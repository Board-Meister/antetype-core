var s=(e=>(e.STRUCTURE="antetype.structure",e.MIDDLE="antetype.structure.middle",e.BAR_BOTTOM="antetype.structure.bar.bottom",e.CENTER="antetype.structure.center",e.COLUMN_LEFT="antetype.structure.column.left",e.COLUMN_RIGHT="antetype.structure.column.right",e.BAR_TOP="antetype.structure.bar.top",e.MODULES="antetype.modules",e))(s||{});var u=(t=>(t.INIT="antetype.init",t.DRAW="antetype.draw",t.CALC="antetype.calc",t))(u||{}),i=class{#t;#r=null;#e=null;static inject={minstrel:"boardmeister/minstrel",herald:"boardmeister/herald"};inject(r){this.#t=r}async#a(r,a){if(!this.#e){let t=this.#t.minstrel.getResourceUrl(this,"core.js");this.#r=(await import(t)).default,this.#e=this.#r({canvas:a,modules:r,injected:this.#t})}return this.#e}async register(r){let{modules:a,canvas:t}=r.detail;a.core=await this.#a(a,t)}async init(r){if(!this.#e)throw new Error("Instance not loaded, trigger registration event first");let{base:a,settings:t}=r.detail;for(let o in t)this.#e.setting.set(o,t[o]);let n={type:"document",base:a,layout:[],start:{x:0,y:0},size:{w:0,h:0}},l=[];return(this.#e.setting.get("fonts")??[]).forEach(o=>{l.push(this.#e.font.load(o))}),await Promise.all(l),n.layout=await this.#e.view.recalculate(n,n.base),await this.#e.view.redraw(n.layout),n}static subscriptions={[s.MODULES]:"register","antetype.init":"init"}},c=i,I=c;export{i as AntetypeCore,u as Event,I as default};
